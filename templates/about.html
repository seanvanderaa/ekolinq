{% extends "base.html" %}

{% block title %}About Us | EkoLinq{% endblock %}
{% block meta_description %}Meet the EkoLinq team: our mission to reduce textile waste and build a greener future together.{% endblock %}
{% block og_image %}{{ url_for('static', filename='images/EkoLinq_Square_Logo_GBG.png') }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/about_styles.css') }}">
{% endblock %}

{% block content %}
<main>
  <div id="header-wrapper">
    <div class="content-width" id="header">
      <div id="header-left">
        <h1>Who We Are</h1>
        <div id="desk-icons">
          <div id="header-icons" class="align-left">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2022.svg') }}" alt="EkoLinq was a neighborhood favorite in 2022.">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2023.svg') }}" alt="EkoLinq was a neighborhood favorite in 2023.">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2024.svg') }}" alt="EkoLinq was a neighborhood favorite in 2024.">
          </div>
          <p>EkoLinq has been a proud "Neighborhood Fave" on <a id="header-a" target="_blank" href="https://nextdoor.com/pages/ekolinq-irvine-ca/?init_source=search&query=EkoLinq">Nextdoor</a> for three consecutive years.</p>
        </div>
      </div>
      <h4>EkoLinq is a family-owned business dedicated to building a more sustainable future in California’s Tri-Valley region by keeping clothing in use and out of landfills. Founded in 2021, EkoLinq was born from a moment of inspiration after our founder read <a class="a-green" target="_blank" href="https://www.goodreads.com/book/show/42972014-secondhand">Secondhand</a> by Adam Minter—a powerful look into the global secondhand economy and the urgent need for local solutions to textile waste.</h4>
      <div id="mobile-icons">
        <div id="header-icons" class="align-left">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2022.svg') }}" alt="EkoLinq was a neighborhood favorite in 2024.">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2023.svg') }}" alt="EkoLinq was a neighborhood favorite in 2024.">
            <img src="{{ url_for('static', filename='images/neighborhood_fave_2024.svg') }}" alt="EkoLinq was a neighborhood favorite in 2024.">
        </div>
        <p>EkoLinq has been a proud "Neighborhood Fave" on <a id="mobile-header-a" target="_blank" href="https://nextdoor.com/pages/ekolinq-irvine-ca/?init_source=search&query=EkoLinq">Nextdoor</a> for three consecutive years.</p>
      </div>
    </div>
  </div>
  <div class="content-width align-center" id="block-text">
    <div id="block-text-center" class="align-center">
      <div class="align-left" id="lightbulb-wrapper">
        <div id="lightbulb" class="align-center"><i class="bi bi-lightbulb"></i></div>
      </div>
      <h4>At EkoLinq, we believe the best path forward is simple: <strong>reuse what we can and recycle what we can’t</strong>. Our priority is to extend the life of clothing by encouraging reuse in its original form—this is not only the most environmentally friendly option but also the most impactful. When garments are too damaged to wear again, we work to ensure they are responsibly recycled so their materials can be transformed and used again.</h4>
    </div>
  </div>
  <div class="content-width" id="final">
    <div id="final-left">
      <h1>Through community partnerships, education, and action, <strong>EkoLinq is helping shift the culture of waste in our region one garment at a time.</strong></h1>
      <h4>If you’d like to be a part of our mission of helping the environment, <a href="/request_init" class="a-green">schedule a pickup of your unwanted clothes.</a></h4>
    </div>
    <img id="pleasanton" src="{{ url_for('static', filename='images/pleasanton.jpg') }}" alt="An overhead view of Pleasanton, EkoLinq's home base.">
  </div>
  <!-- Testimonials Section -->
  <section id="testimonials" class="content-width align-center">
    <p><b>Testimonials</b></p>
    <div class="testimonial-slider">
      <div class="testimonial-slide active">
        <h3>“Scheduling a pick-up was so easy, and it felt great knowing my old clothes wouldn’t end up in the trash. EkoLinq made it totally hassle-free—I just left the bag out and they handled the rest!”</h3>
        <h4><b>Jenna L., Pleasanton</b></h4>
      </div>
      <div class="testimonial-slide">
        <h3>“Ekolinq is always responsive and reliable with scheduling, and pickups are consistently on time. We’re so grateful to have found such a dependable solution for responsibly recycling clothing, shoes, and accessories.”</h3>
        <h4><b>Resident, Danville</b></h4>
      </div>
      <div class="testimonial-slide">
        <h3>“I love what EkoLinq is doing for our environment and community. Knowing my donations are actually being reused or recycled makes a big difference to me. It’s a great way to give back and reduce waste.”</h3>
        <h4><b>Michael R., San Ramon</b></h4>
      </div>
    </div>

    <!-- navigation controls -->
    <div class="testimonial-nav">
      <button class="chevron prev" aria-label="Previous testimonial"><i class="bi bi-chevron-left"></i></button>
      <div class="dots"></div>
      <button class="chevron next" aria-label="Next testimonial"><i class="bi bi-chevron-right"></i></button>
    </div>
  </section>
  <div id="request-form" class="content-width">
    <h2>Can we help get rid of your unwanted clothes?</h2>
    <p>Enter your zipcode below to schedule a pickup.</p>
    <form action="/find-time" method="GET" id="request-form-input">
      <div id="request-form-input-inner">
        <input type="text" id="zipcode" name="zipcode" placeholder="Enter ZIP Code"
          class="align-center" required>
        <span class="info-icon">i</span>
        <div class="info-text">We only use this ZIP code to determine pick-up dates and eligibility. EkoLinq currently only serves the Tri-Valley.</div>
      </div>
      <button class="main-btn" type="submit"><span>Find a Time</span></button>
    </form>
  </div>
</main>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script nonce="{{ csp_nonce() }}">
    // carousel.js
    document.addEventListener("DOMContentLoaded", () => {
      const slides = Array.from(document.querySelectorAll(".testimonial-slide"));
      const prevBtn = document.querySelector(".testimonial-nav .prev");
      const nextBtn = document.querySelector(".testimonial-nav .next");
      const dotsContainer = document.querySelector(".testimonial-nav .dots");
      let current = 0;
      let interval;

      // build dots
      slides.forEach((_, i) => {
        const dot = document.createElement("span");
        dot.classList.add("dot");
        if (i === 0) dot.classList.add("active");
        dot.addEventListener("click", () => goTo(i));
        dotsContainer.appendChild(dot);
      });
      const dots = Array.from(dotsContainer.children);

      function update() {
        slides.forEach((s, i) => {
          s.classList.toggle("active", i === current);
          dots[i].classList.toggle("active", i === current);
        });
      }

      function next() { current = (current + 1) % slides.length; update(); }
      function prev() { current = (current - 1 + slides.length) % slides.length; update(); }
      function goTo(idx) { current = idx; update(); resetInterval(); }

      prevBtn.addEventListener("click", () => { prev(); resetInterval(); });
      nextBtn.addEventListener("click", () => { next(); resetInterval(); });

      function startInterval() {
        interval = setInterval(next, 8000); // slide every 5s
      }
      function resetInterval() {
        clearInterval(interval);
        startInterval();
      }

      // pause on hover
      document.querySelector(".testimonial-slider")
        .addEventListener("mouseenter", () => clearInterval(interval));
      document.querySelector(".testimonial-slider")
        .addEventListener("mouseleave", startInterval);

      // kick it off
      startInterval();
      
      document.getElementById('request-form-input').addEventListener('submit', async function (event) {
          event.preventDefault(); // Prevent default form submission
      
          const zipcode = document.getElementById('zipcode').value;
      
          // Make an AJAX request to the Flask endpoint
          const response = await fetch(`/verify_zip?zipcode=${zipcode}`);
          const data = await response.json();
      
          if (data.valid) {
            // Redirect to /request_pickup if ZIP code is valid
            window.location.href = `/request_pickup?zipcode=${zipcode}`;
          } else {
            // Display an alert with the invalid reason
            alert(`${data.reason}`);
          }
        });
    });
  </script>
{% endblock %}
